VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "COMDLG32.OCX"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCTL.OCX"
Begin VB.Form FMain 
   Caption         =   "VB Help WorkShop Wizard"
   ClientHeight    =   9375
   ClientLeft      =   60
   ClientTop       =   630
   ClientWidth     =   9915
   Icon            =   "FMain.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   625
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   661
   StartUpPosition =   2  'CenterScreen
   Begin MSComctlLib.ImageList ImageList1 
      Left            =   1440
      Top             =   8400
      _ExtentX        =   1005
      _ExtentY        =   1005
      BackColor       =   -2147483643
      ImageWidth      =   16
      ImageHeight     =   16
      MaskColor       =   12632256
      _Version        =   393216
      BeginProperty Images {2C247F25-8591-11D1-B16A-00C0F0283628} 
         NumListImages   =   33
         BeginProperty ListImage1 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":0ABA
            Key             =   ""
         EndProperty
         BeginProperty ListImage2 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":104E
            Key             =   ""
         EndProperty
         BeginProperty ListImage3 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":14A2
            Key             =   ""
         EndProperty
         BeginProperty ListImage4 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":18F6
            Key             =   ""
         EndProperty
         BeginProperty ListImage5 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":1D4A
            Key             =   ""
         EndProperty
         BeginProperty ListImage6 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":22DE
            Key             =   ""
         EndProperty
         BeginProperty ListImage7 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":25FA
            Key             =   ""
         EndProperty
         BeginProperty ListImage8 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":2916
            Key             =   ""
         EndProperty
         BeginProperty ListImage9 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":2D6A
            Key             =   ""
         EndProperty
         BeginProperty ListImage10 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":31BE
            Key             =   ""
         EndProperty
         BeginProperty ListImage11 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":34DA
            Key             =   ""
         EndProperty
         BeginProperty ListImage12 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":37F6
            Key             =   ""
         EndProperty
         BeginProperty ListImage13 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":3C4A
            Key             =   ""
         EndProperty
         BeginProperty ListImage14 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":3F66
            Key             =   ""
         EndProperty
         BeginProperty ListImage15 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":43BA
            Key             =   ""
         EndProperty
         BeginProperty ListImage16 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":46D6
            Key             =   ""
         EndProperty
         BeginProperty ListImage17 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":49F2
            Key             =   ""
         EndProperty
         BeginProperty ListImage18 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":4E44
            Key             =   ""
         EndProperty
         BeginProperty ListImage19 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":515E
            Key             =   ""
         EndProperty
         BeginProperty ListImage20 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":56F0
            Key             =   ""
         EndProperty
         BeginProperty ListImage21 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":5B42
            Key             =   ""
         EndProperty
         BeginProperty ListImage22 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":5E5C
            Key             =   ""
         EndProperty
         BeginProperty ListImage23 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":6176
            Key             =   ""
         EndProperty
         BeginProperty ListImage24 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":6490
            Key             =   ""
         EndProperty
         BeginProperty ListImage25 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":67AA
            Key             =   ""
         EndProperty
         BeginProperty ListImage26 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":6AC4
            Key             =   ""
         EndProperty
         BeginProperty ListImage27 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":6DDE
            Key             =   ""
         EndProperty
         BeginProperty ListImage28 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":7230
            Key             =   ""
         EndProperty
         BeginProperty ListImage29 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":754A
            Key             =   ""
         EndProperty
         BeginProperty ListImage30 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":7864
            Key             =   ""
         EndProperty
         BeginProperty ListImage31 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":7B7E
            Key             =   ""
         EndProperty
         BeginProperty ListImage32 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":8110
            Key             =   ""
         EndProperty
         BeginProperty ListImage33 {2C247F27-8591-11D1-B16A-00C0F0283628} 
            Picture         =   "FMain.frx":8562
            Key             =   ""
         EndProperty
      EndProperty
   End
   Begin VB.PictureBox Picture1 
      Appearance      =   0  'Flat
      BackColor       =   &H80000005&
      ForeColor       =   &H80000008&
      Height          =   855
      Left            =   60
      ScaleHeight     =   55
      ScaleMode       =   3  'Pixel
      ScaleWidth      =   651
      TabIndex        =   22
      Top             =   0
      Width           =   9795
      Begin VB.Label Label3 
         BackStyle       =   0  'Transparent
         Caption         =   "Open an existing *.vhw or VB6 project"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   60
         TabIndex        =   25
         Top             =   60
         Width           =   8415
      End
      Begin VB.Image Image2 
         Height          =   735
         Index           =   2
         Left            =   9000
         Picture         =   "FMain.frx":89B4
         Top             =   60
         Width           =   735
      End
      Begin VB.Label Label1 
         BackStyle       =   0  'Transparent
         Caption         =   "Label1"
         ForeColor       =   &H00000000&
         Height          =   195
         Left            =   120
         TabIndex        =   24
         Top             =   300
         Width           =   9135
      End
      Begin VB.Label Label2 
         BackStyle       =   0  'Transparent
         Caption         =   "Label2"
         ForeColor       =   &H00000000&
         Height          =   255
         Left            =   120
         TabIndex        =   23
         Top             =   540
         Width           =   9195
      End
   End
   Begin VB.Frame Frame1 
      Height          =   75
      Left            =   0
      TabIndex        =   17
      Top             =   1500
      Width           =   9735
   End
   Begin MSComctlLib.StatusBar SB1 
      Align           =   2  'Align Bottom
      Height          =   315
      Left            =   0
      TabIndex        =   14
      Top             =   9060
      Width           =   9915
      _ExtentX        =   17489
      _ExtentY        =   556
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   2
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   8467
         EndProperty
         BeginProperty Panel2 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            AutoSize        =   1
            Object.Width           =   8467
         EndProperty
      EndProperty
   End
   Begin VB.PictureBox PBar 
      BorderStyle     =   0  'None
      Height          =   660
      Left            =   60
      ScaleHeight     =   660
      ScaleWidth      =   9915
      TabIndex        =   12
      Top             =   900
      Width           =   9915
      Begin VB.CommandButton Command7 
         Caption         =   "&Save vhw"
         Height          =   555
         Left            =   1200
         Picture         =   "FMain.frx":8B9F
         Style           =   1  'Graphical
         TabIndex        =   28
         ToolTipText     =   "Save  vhw project file"
         Top             =   0
         Width           =   1095
      End
      Begin VB.CommandButton Command5 
         Caption         =   "&Open vhw"
         Height          =   555
         Left            =   0
         Picture         =   "FMain.frx":90E1
         Style           =   1  'Graphical
         TabIndex        =   27
         ToolTipText     =   "Open vhw file"
         Top             =   0
         Width           =   1155
      End
      Begin VB.CommandButton Command2 
         Caption         =   "&Generate HELP"
         Height          =   555
         Left            =   4260
         Picture         =   "FMain.frx":922B
         Style           =   1  'Graphical
         TabIndex        =   18
         Top             =   0
         Width           =   1575
      End
      Begin VB.CommandButton Command4 
         Height          =   315
         Left            =   6240
         Picture         =   "FMain.frx":9375
         Style           =   1  'Graphical
         TabIndex        =   15
         Top             =   240
         Width           =   375
      End
      Begin VB.CommandButton Command1 
         Appearance      =   0  'Flat
         Caption         =   "&VB Project/Options"
         Height          =   555
         Left            =   2580
         Picture         =   "FMain.frx":94BF
         Style           =   1  'Graphical
         TabIndex        =   13
         ToolTipText     =   "Open VB Project"
         Top             =   0
         Width           =   1635
      End
      Begin VB.Label Label9 
         Caption         =   "www.sourcecode4free.com/cgt ©2001"
         ForeColor       =   &H80000010&
         Height          =   195
         Left            =   6660
         TabIndex        =   16
         Top             =   360
         Width           =   2955
      End
   End
   Begin VB.Frame Frames 
      Height          =   7875
      Index           =   3
      Left            =   4140
      TabIndex        =   0
      Top             =   1560
      Width           =   5715
      Begin VB.CommandButton Command9 
         Height          =   315
         Left            =   4620
         Picture         =   "FMain.frx":9609
         Style           =   1  'Graphical
         TabIndex        =   30
         ToolTipText     =   "Add term to Glossary"
         Top             =   3120
         Width           =   375
      End
      Begin VB.CommandButton Command8 
         Height          =   315
         Left            =   5040
         Picture         =   "FMain.frx":9B93
         Style           =   1  'Graphical
         TabIndex        =   29
         ToolTipText     =   "Add Link"
         Top             =   3120
         Width           =   315
      End
      Begin VB.CommandButton Command6 
         Height          =   315
         Left            =   2460
         Picture         =   "FMain.frx":9C8D
         Style           =   1  'Graphical
         TabIndex        =   21
         ToolTipText     =   "Open VB Project"
         Top             =   4680
         Width           =   375
      End
      Begin VB.Frame Frame2 
         Height          =   2235
         Left            =   60
         TabIndex        =   20
         Top             =   5580
         Width           =   5595
         Begin VB.PictureBox Picture2 
            Appearance      =   0  'Flat
            AutoSize        =   -1  'True
            BackColor       =   &H80000004&
            ForeColor       =   &H80000008&
            Height          =   615
            Left            =   60
            ScaleHeight     =   585
            ScaleWidth      =   585
            TabIndex        =   26
            Top             =   180
            Width           =   615
         End
      End
      Begin VB.CommandButton Command3 
         Height          =   315
         Left            =   4920
         Picture         =   "FMain.frx":9D8F
         Style           =   1  'Graphical
         TabIndex        =   19
         ToolTipText     =   "Open VB Project"
         Top             =   5220
         Width           =   375
      End
      Begin VB.TextBox Text8 
         Appearance      =   0  'Flat
         Height          =   285
         Left            =   180
         TabIndex        =   10
         Text            =   "Text8"
         Top             =   5280
         Width           =   4695
      End
      Begin VB.TextBox Text7 
         Appearance      =   0  'Flat
         Height          =   735
         Left            =   180
         MultiLine       =   -1  'True
         ScrollBars      =   2  'Vertical
         TabIndex        =   8
         Text            =   "FMain.frx":9E91
         Top             =   3660
         Width           =   5295
      End
      Begin VB.ComboBox Combo2 
         Height          =   315
         Left            =   180
         Style           =   2  'Dropdown List
         TabIndex        =   5
         Top             =   4680
         Width           =   2235
      End
      Begin VB.TextBox Text6 
         Appearance      =   0  'Flat
         Height          =   1935
         Left            =   180
         MultiLine       =   -1  'True
         ScrollBars      =   2  'Vertical
         TabIndex        =   4
         Text            =   "FMain.frx":9E97
         Top             =   1140
         Width           =   5235
      End
      Begin VB.TextBox Text5 
         Appearance      =   0  'Flat
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   300
         Left            =   180
         TabIndex        =   2
         Text            =   "Text5"
         Top             =   480
         Width           =   5235
      End
      Begin VB.Label Label16 
         Caption         =   "ScreenShoot"
         Height          =   195
         Left            =   180
         TabIndex        =   9
         Top             =   5040
         Width           =   1095
      End
      Begin VB.Label Label15 
         Caption         =   "Remarks"
         Height          =   195
         Left            =   180
         TabIndex        =   7
         Top             =   3420
         Width           =   1215
      End
      Begin VB.Label Label14 
         Caption         =   "Category"
         Height          =   255
         Left            =   180
         TabIndex        =   6
         Top             =   4440
         Width           =   975
      End
      Begin VB.Label Label13 
         Caption         =   "Description"
         Height          =   255
         Left            =   180
         TabIndex        =   3
         Top             =   900
         Width           =   1155
      End
      Begin VB.Label Label12 
         Caption         =   "Caption/Item"
         Height          =   255
         Left            =   180
         TabIndex        =   1
         Top             =   240
         Width           =   1275
      End
   End
   Begin MSComDlg.CommonDialog CommonDialog1 
      Left            =   3120
      Top             =   5520
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin MSComctlLib.TreeView TV2 
      Height          =   6975
      Left            =   60
      TabIndex        =   11
      Top             =   1620
      Width           =   3975
      _ExtentX        =   7011
      _ExtentY        =   12303
      _Version        =   393217
      Indentation     =   132
      LabelEdit       =   1
      LineStyle       =   1
      Style           =   7
      ImageList       =   "ImageList1"
      Appearance      =   1
   End
   Begin VB.Menu File_m 
      Caption         =   "File"
      Begin VB.Menu New_i 
         Caption         =   "New"
      End
      Begin VB.Menu open_prj 
         Caption         =   "Open"
      End
      Begin VB.Menu Save_i 
         Caption         =   "Save"
      End
      Begin VB.Menu SaveAs_i 
         Caption         =   "Save As"
      End
      Begin VB.Menu sep 
         Caption         =   "-"
      End
      Begin VB.Menu Exit_i 
         Caption         =   "Exit"
      End
   End
   Begin VB.Menu Proj 
      Caption         =   "Project"
      Begin VB.Menu OpenVBPrj_i 
         Caption         =   "Setup Project"
      End
      Begin VB.Menu Gen_hlp 
         Caption         =   "Generate Help"
      End
   End
End
Attribute VB_Name = "FMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False

 
Sub BuildAdditionalPages()

Dim File As String


' ********** crea le pagine aggiuntive

 If Prj.AdFlag(0) Then
    File = Prj.HTMLPath & "\CopyRight.htm"
    Prj.AddFiles(1) = File
    TPL$ = App.Path & "\templates\legal.txt"
    Open File For Output As 1
    Open TPL For Input As 2
      WriteHeader 1
      Do Until EOF(2)
         Line Input #2, St
         Print #1, St
      Loop
     PrintFooter 1
    Close 1
    Close 2
 End If

 If Prj.AdFlag(2) Then
    File = Prj.HTMLPath & "\WhatsNew.htm"
    Prj.AddFiles(2) = File
    TPL$ = App.Path & "\templates\WhatsNew.txt"
    Open File For Output As 1
    Open TPL For Input As 2
      WriteHeader 1
      Do Until EOF(2)
         Line Input #2, St
         Print #1, St
      Loop
     PrintFooter 1
    Close 1
    Close 2
 End If

 
 

' Crea i files di progetto per Microsoft HTML WorkShop


 If Prj.GenHHP Then  ' Generate HTML WorkShop files
   File = Prj.HTMLPath & "\" & Prj.ProjectName & ".hhp"
   Open File For Output As 1
    Print #1, "[Options]"
    Print #1, "Compatibility = 1.1"
    Print #1, "Compiled File = " & Prj.ProjectName & ".chm"
    Print #1, "Contents file=" & Prj.HTMLPath & "\Table_of_Contents.hhc"
    Print #1, "Default topic=" & Prj.HTMLPath & "\Index.htm"
    Print #1, "Display compile progress=No"
    'Print #1,"Language=0x410 Italiano (Italia)"

    Print #1, "[Files]"
    For i = 1 To Files.Count
            Print #1, Prj.HTMLPath & "\" & TrimExt(Files(i).ClassName) & ".htm"
    Next

    Close 1
    
' Table of Contents
   File = Prj.HTMLPath & "\Table_of_Contents.hhc"
   Open File For Output As 1
     Print #1, "<!DOCTYPE HTML PUBLIC ""-//IETF//DTD HTML//EN"">"
     Print #1, "<HTML>"
     Print #1, "<HEAD>"
     Print #1, "<meta name=""GENERATOR"" content=""VB/CGT&reg; VB Help Workshop 1.0"">"
     Print #1, "<!-- Sitemap 1.0 -->"
     Print #1, "</HEAD><BODY>"
     Print #1, "<OBJECT type=""text/site properties"">"
     Print #1, "    <param name=""ImageType"" value=""Folder"">"
     Print #1, "</OBJECT>"
     Print #1, "<UL>"
     Print #1, "    <LI> <OBJECT type=""text/sitemap"">"
     Print #1, "        <param name=""Name"" value=""" & Prj.ProjectName & " Guide"">"
     Print #1, "        <param name=""ImageNumber"" value=""1"">"
     Print #1, "        </OBJECT>"
     Print #1, "    <UL>"
     Print #1, "        <LI> <OBJECT type=""text/sitemap"">"
     Print #1, "            <param name=""Name"" value=""Index"">"
     Print #1, "            <param name=""Local"" value=""Index.htm"">"
     Print #1, "            </OBJECT>"
     Print #1, "    </UL>"
     
     For i = 1 To 5
       If Len(Prj.AddFiles(i)) > 0 Then
             FL$ = ExtractFileFromString(Prj.AddFiles(i))
             TT$ = EstraiNomeFile(FL)
             Print #1, "    <UL>"
             Print #1, "        <LI> <OBJECT type=""text/sitemap"">"
             Print #1, "            <param name=""Name"" value=""" & TT & """>"
             Print #1, "            <param name=""Local"" value=""" & FL & """>"
             Print #1, "            </OBJECT>"
             Print #1, "    </UL>"
       End If
     Next
     
     ok = False
     For i = 1 To Files.Count
         If Files(i).ModuleType = "CTL" Then
            If Not ok Then
                Print #1, "    <LI> <OBJECT type=""text/sitemap"">"
                Print #1, "        <param name=""Name"" value=""Controls"">"
                Print #1, "        <param name=""ImageNumber"" value=""1"">"
                Print #1, "        </OBJECT>"
                ok = True
            End If
            Print #1, "    <UL>"
            Print #1, "        <LI> <OBJECT type=""text/sitemap"">"
            Print #1, "            <param name=""Name"" value=""" & Files(i).ClassName & """>"
            Print #1, "            <param name=""Local"" value=""" & TrimExt(Files(i).ClassName) & ".htm"">"
            Print #1, "            </OBJECT>"
            Print #1, "    </UL>"
         End If
     Next
     
     
     ok = False
     For i = 1 To Files.Count
         If Files(i).ModuleType = "FRM" Then
            If Not ok Then
                Print #1, "    <LI> <OBJECT type=""text/sitemap"">"
                Print #1, "        <param name=""Name"" value=""Forms"">"
                Print #1, "        <param name=""ImageNumber"" value=""1"">"
                Print #1, "        </OBJECT>"
                ok = True
            End If
            Print #1, "    <UL>"
            Print #1, "        <LI> <OBJECT type=""text/sitemap"">"
            Print #1, "            <param name=""Name"" value=""" & Files(i).ClassName & """>"
            Print #1, "            <param name=""Local"" value=""" & TrimExt(Files(i).ClassName) & ".htm"">"
            Print #1, "            </OBJECT>"
            Print #1, "    </UL>"
            'Print #1, HTMLPath & "\" & TrimExt(Files(i).ClassName) & ".htm"
         End If
     Next
   
   If Prj.OutputMode = 1 Then GoTo naa
     
     ok = False
     For i = 1 To Files.Count
         If Files(i).ModuleType = "CLS" Then
            If Not ok Then
                Print #1, "    <LI> <OBJECT type=""text/sitemap"">"
                Print #1, "        <param name=""Name"" value=""Objects"">"
                Print #1, "        <param name=""ImageNumber"" value=""1"">"
                Print #1, "        </OBJECT>"
                ok = True
            End If
            Print #1, "    <UL>"
            Print #1, "        <LI> <OBJECT type=""text/sitemap"">"
            Print #1, "            <param name=""Name"" value=""" & Files(i).ClassName & """>"
            Print #1, "            <param name=""Local"" value=""" & TrimExt(Files(i).ClassName) & ".htm"">"
            Print #1, "            </OBJECT>"
            Print #1, "    </UL>"
         End If
     Next
     
     ok = False
     For i = 1 To Files.Count
         If Files(i).ModuleType = "BAS" Then
            If Not ok Then
                Print #1, "    <LI> <OBJECT type=""text/sitemap"">"
                Print #1, "        <param name=""Name"" value=""Modules"">"
                Print #1, "        <param name=""ImageNumber"" value=""1"">"
                Print #1, "        </OBJECT>"
                ok = True
            End If
            Print #1, "    <UL>"
            Print #1, "        <LI> <OBJECT type=""text/sitemap"">"
            Print #1, "            <param name=""Name"" value=""" & Files(i).ClassName & """>"
            Print #1, "            <param name=""Local"" value=""" & TrimExt(Files(i).ClassName) & ".htm"">"
            Print #1, "            </OBJECT>"
            Print #1, "    </UL>"
         End If
     Next
     
naa:

' verifica le categorie
     
    ' For i = 1 To nCat
    '     Cat = Cats(i)
    '     Print #1, "    <LI> <OBJECT type=""text/sitemap"">"
    '     Print #1, "        <param name=""Name"" value=""" & Cat & """>"
    '     Print #1, "        <param name=""ImageNumber"" value=""1"">"
    '     Print #1, "        </OBJECT>"
    '
   '
    ' Next

     Print #1, "</UL>"
     Print #1, "</BODY></HTML>"
    
   Close 1
    
    
 End If
 
 
End Sub

Sub Convert()
  Dim Indexfile As String
  Dim ok As Boolean
  Indexfile = Prj.HTMLPath & "\Index.htm"
  Open Indexfile For Output As 1
  
  
  
  WriteHeader 1
  
  ok = False
  For i = 1 To Files.Count
      If Files(i).ModuleType = "CTL" And OutputMode = 0 Then
         If Not ok Then
             Print #1, "<BR><strong><FONT SIZE=""3"" COLOR=""#000040"">Controls</strong></FONT>"
             Print #1, "<HR SIZE=""1"" WIDTH=""100%"">"
             ok = True
         End If
         Print #1, "<A HREF=""" & TrimExt(Files(i).ClassName) & ".htm"">" & TrimExt(Files(i).Caption) & "</A>"
         Print #1, "<BR>"
      End If
  Next
  
  
  ok = False
  For i = 1 To Files.Count
      If Files(i).ModuleType = "FRM" Then
         If Not ok Then
           Print #1, "<BR><strong><FONT SIZE=""3"" COLOR=""#000040"">Forms</strong></FONT>"
           Print #1, "<HR SIZE=""1"" WIDTH=""100%"">"
           ok = True
         End If
         Print #1, "<A HREF=""" & TrimExt(Files(i).ClassName) & ".htm"">" & TrimExt(Files(i).Caption) & "</A>"
         Print #1, "<BR>"
      End If
  Next
  
  If Prj.OutputMode > 0 Then GoTo NoProgr ' if App Doc only skips the next statements
  
  ok = False
  For i = 1 To Files.Count
      If Files(i).ModuleType = "CLS" Then
         If Not ok Then
            Print #1, "<BR><strong><FONT SIZE=""3"" COLOR=""#000040"">Object Classes</strong></FONT>"
            Print #1, "<HR SIZE=""1"" WIDTH=""100%"">"
            ok = True
         End If
         Print #1, "<A HREF=""" & TrimExt(Files(i).ClassName) & ".htm"">" & TrimExt(Files(i).Caption) & "</A>"
         Print #1, "<BR>"
      End If
  Next
  
  
  ok = False
  For i = 1 To Files.Count
      If Files(i).ModuleType = "BAS" Then
         If Not ok Then
             Print #1, "<BR><strong><FONT SIZE=""3"" COLOR=""#000040"">Modules</strong></FONT>"
             Print #1, "<HR SIZE=""1"" WIDTH=""100%"">"
             ok = True
         End If
         Print #1, "<A HREF=""" & TrimExt(Files(i).ClassName) & ".htm"">" & TrimExt(Files(i).Caption) & "</A>"
         Print #1, "<BR>"
      End If
  Next
  
NoProgr:
  
  PrintFooter 1
  
  Close 1
  
  
' Save modules to html pages
  For i = 1 To Files.Count
      If Prj.OutputMode = 0 Then
         Files(i).ExportToHtml
      ElseIf Files(i).ModuleType = "FRM" Then
         Files(i).WriteDoc
      End If
  Next

  BuildAdditionalPages

End Sub

Sub FillCats()
   On Error Resume Next
   Combo2.Clear
   Combo2.AddItem "<Global Topic>"
   For i = 1 To Prj.nCat
      Combo2.AddItem Prj.Cats(i)
   Next
   Combo2.ListIndex = 0
End Sub

Sub FillTV2()
 Dim itmx As Node, i As Long, KD As String, Dx As String
 Dim ok As Boolean, Ico As Long
 
 TV2.Nodes.Clear
 
Set itmx = TV2.Nodes.Add(, , "PRJ0", "VB Project: " & Prj.ProjectName & "[" & Prj.ProjectType & "]", 12, 12)
If Prj.OutputMode = 1 Then
 ok = False
 For i = 1 To Files.Count
     If Files(i).ModuleType = "FRM" Then
        If Not ok Then Set itmx = TV2.Nodes.Add("PRJ0", tvwChild, "FRM", "Forms", 5, 5)
        Set itmx = TV2.Nodes.Add("FRM", tvwChild, Files(i).Key, Files(i).ClassName, 5, 5)
        For j = 1 To Files(i).Objects.Count
           Files(i).Objects(j).AddToTree TV2, Files(i).Key
        Next
        ok = True
     End If
 Next
Else
 On Error Resume Next
 For i = 1 To Files.Count
    GoSub GetType
    Set itmx = TV2.Nodes.Add("PRJ0", tvwChild, Files(i).ModuleType, Dx, Ico, Ico)
 Next
 
 For i = 1 To Files.Count
        GoSub GetType
        Set itmx = TV2.Nodes.Add(KD, tvwChild, Files(i).Key, Files(i).ClassName, Ico, Ico)
        For j = 1 To Files(i).Procs.Count
            Set itmx = TV2.Nodes.Add(Files(i).Key, tvwChild, Files(i).Procs(j).Key, Files(i).Procs(j).FullName, 11, 11)
        Next
 Next
End If

Exit Sub
 
 
GetType:
    Ico = 1
    KD$ = Files(i).ModuleType
    Select Case KD
     Case "FRM": Dx$ = "Forms": Ico = 5
     Case "BAS": Dx$ = "Modules": Ico = 7
     Case "CLS": Dx$ = "Object Classes": Ico = 31
     Case "CTL": Dx$ = "Object Controls": Ico = 3
    End Select

Return
 
 
 
 '======================
 Set itmx = TV2.Nodes.Add("PRJ0", tvwChild, "FRM", "Forms")
 Set itmx = TV2.Nodes.Add("PRJ0", tvwChild, "BAS", "Modules")
 Set itmx = TV2.Nodes.Add("PRJ0", tvwChild, "CLS", "Classes")
 Set itmx = TV2.Nodes.Add("PRJ0", tvwChild, "CTL", "User Controls")
 
 For i = 1 To Files.Count
 
   Select Case Files(i).ModuleType
     Case "BAS": Root$ = "BAS"
     Case "CLS": Root$ = "CLS"
     Case "FRM": Root$ = "FRM"
     Case "CTL": Root$ = "CTL"
   End Select
       
     Set itmx = TV2.Nodes.Add(Root, tvwChild, Files(i).Key, Files(i).ClassName)
     
     Set itmx = TV2.Nodes.Add(Files(i).Key, tvwChild, "V" & Files(i).Key, "Declarations")
     Set itmx = TV2.Nodes.Add("V" & Files(i).Key, tvwChild, "U1" & Files(i).Key, "User Types")
     Set itmx = TV2.Nodes.Add("V" & Files(i).Key, tvwChild, "U2" & Files(i).Key, "Public")
     Set itmx = TV2.Nodes.Add("V" & Files(i).Key, tvwChild, "U3" & Files(i).Key, "Private")
     Set itmx = TV2.Nodes.Add(Files(i).Key, tvwChild, "P" & Files(i).Key, "Public Procedures")
     Set itmx = TV2.Nodes.Add(Files(i).Key, tvwChild, "R" & Files(i).Key, "Private Procedures")
     
     For j = 1 To Files(i).UTypes.Count
        With Files(i).UTypes(j)
            Root$ = "U1" & Files(i).Key
            Key$ = Root$ & Format(j, "00")
            Set itmx = TV2.Nodes.Add(Root$, tvwChild, Key, .Name)
            Root$ = Key
            For b = 1 To .Vars.Count
                Key$ = Root & Format(b, "00")
                Var$ = .Vars(b).Name & " As " & .Vars(b).varType
               Set itmx = TV2.Nodes.Add(Root, tvwChild, Key, Var)
           Next
       End With
     Next
     
     
     For j = 1 To Files(i).Vars.Count
        With Files(i).Vars(j)
            If .Mode = "Public" Then
                Root$ = "U2" & Files(i).Key
            Else
                Root$ = "U3" & Files(i).Key
            End If
            Key$ = Root$ & Format(j, "00")
            Var$ = .Name & " As " & .varType
            Set itmx = TV2.Nodes.Add(Root$, tvwChild, Key, Var)
        End With
     Next
     
     
     
     For j = 1 To Files(i).Procs.Count
        With Files(i).Procs(j)
          If .IsPublic Then
              Root$ = "P" & Files(i).Key
          Else
              Root$ = "R" & Files(i).Key
          End If
            Key$ = Root$ & Format(j, "00")
            Set itmx = TV2.Nodes.Add(Root$, tvwChild, Key, .FullName)
        End With
     Next
    
 Next

End Sub

Sub ShowFrame()
 Dim i&
 For i = 0 To NF
   Frames(i).Visible = False
 Next
  Frames(CurFrame).Visible = True
End Sub




Private Sub Combo2_Click()
  CurObj.HelpTopic = Combo2.List(Combo2.ListIndex)
End Sub


Private Sub Command1_Click()
  fOptions.Show 1
  If Len(Prj.ProjectFile) = 0 Then Exit Sub
  Label1 = "Source.....: " & Prj.ProjectFile
  Label2 = "Destination: " & Prj.HTMLPath
  SB1.Panels(1) = Prj.ProjectName '& Prj.ProjectVersion
  Label3 = "Customize the items and press Generate Help when done"
  FillTV2
End Sub

Private Sub Command2_Click()
  Screen.MousePointer = 11
  Convert
  Screen.MousePointer = 0
  Beep
  Label3 = "Help has been created on destination folder. Save the project for future changes"
End Sub

Private Sub Command3_Click()
  With CommonDialog1
    .Filter = "Image Files (*.gif,*.jpg)|*.gif;*.jpg"
    .FileName = ""
    .ShowOpen
    Text8 = .FileName
  End With

End Sub

Private Sub Command4_Click()
  fAbout.Show 1
End Sub

Private Sub Command5_Click()
open_prj_Click
End Sub

Private Sub Command6_Click()
  fCat.Show 1
  FillCats

End Sub

Private Sub Command7_Click()
Save_i_Click
End Sub

Private Sub Command8_Click()
 Dim t As String
 
 LinkedURL = ""
 
 If Text6.SelLength > 0 Then
    LinkedText = Mid(Text6, Text6.SelStart + 1, Text6.SelLength)
 Else
    LinkedText = ""
    
 End If
 
 fLink.Show 1
 '
 If Len(LinkedText) > 0 And Len(LinkedURL) > 0 Then
    t = "<A HREF=""" & LinkedURL & """>" & LinkedText & "</A>"
    If Text6.SelLength > 0 Then
       Text6 = Replace(Text6, Mid(Text6, Text6.SelStart + 1, Text6.SelLength), t)
    Else
       Text6 = Text6 & t
    End If
 End If
End Sub

Private Sub Exit_i_Click()
End
End Sub

Private Sub Form_Load()
 ChangeFont Me
 Set CurObj = New cObj
 Text5 = ""
 Text2 = App.Path & "\test"
 Label1 = ""
 Label2 = ""
 Text6 = ""
 Text7 = ""
 Text8 = ""
 Prj.HTMLPath = App.Path & "\test"
 License = GetSetting("VBHW", "Settings", "License")
 Demo = License <> "GBD-A65-7YU-340-54DB"
 If Demo Then Label11 = "Unregistered" Else Label11 = ""
 
 FillCats
End Sub


Private Sub Form_Resize()
  
  On Error Resume Next
  
  Frame1.Left = Picture1.Left
  Picture1.Width = ScaleWidth - Picture1.Left * 2
  Frame1.Width = Picture1.Width
  
  Image2(2).Left = Picture1.ScaleWidth - Image2(2).Width - 5
  
  Frames(3).Left = ScaleWidth - Frames(3).Width - 5
  TV2.Width = Frames(3).Left - TV2.Left * 2
  
  TV2.Height = ScaleHeight - (TV2.Top + SB1.Height)
  Frames(3).Height = TV2.Height
  Frame2.Height = (Frames(3).Height - (Frame2.Top / Screen.TwipsPerPixelY + 5)) * Screen.TwipsPerPixelY
End Sub


Private Sub Gen_hlp_Click()
  Command2_Click
End Sub

Private Sub New_i_Click()

Label3 = "Open an existing *.vhw or VB6 project"
TV2.Nodes.Clear

For i = 1 To Files.Count
  Files.Remove 1
Next
Label1 = ""
Label2 = ""
Dim P As rParm
Prj = P
Set CurObj = Nothing

LastFile = ""
End Sub

Private Sub open_prj_Click()
  
  New_i_Click

  With CommonDialog1
     .Filter = "VB Help WorkShop Projects (*.vhw)|*.vhw"
     .FileName = ""
     .ShowOpen
     If Len(.FileName) > 0 Then
       LastFile = .FileName
       OpenPrj .FileName
       If Len(Prj.ProjectFile) = 0 Then Exit Sub
       Label1 = "Source.....: " & Prj.ProjectFile
       Label2 = "Destination: " & Prj.HTMLPath
       SB1.Panels(1) = Prj.ProjectName '& Prj.ProjectVersion
       Label3 = "Customize the items and press Generate Help when done"
       FillTV2
     End If
  End With

End Sub

Private Sub OpenVBPrj_i_Click()
 Command1_Click
End Sub

Private Sub Save_i_Click()
 If Len(LastFile) > 0 Then
    SavePrj LastFile
 Else
    SaveAs_i_Click
 End If
End Sub

Private Sub SaveAs_i_Click()
  With CommonDialog1
     .Filter = "VB Help WorkShop Projects (*.vhw)|*.vhw"
     .FileName = ""
     .ShowSave
     If Len(.FileName) > 0 Then
        SavePrj .FileName
        LastFile = .FileName
     End If
  End With

End Sub


Private Sub Text5_Change()
  CurObj.Caption = Text5
End Sub

Private Sub Text6_Change()
 CurObj.HelpDex = Text6
End Sub

Private Sub Text7_Change()
  CurObj.HelpRemarks = Text7
End Sub


Private Sub Text8_Change()
  CurObj.HelpScreenShoot = Text8
  If Len(Text8) > 0 Then Picture2.Picture = LoadPicture(Text8) Else Set Picture2.Picture = Nothing
End Sub

Private Sub TV2_NodeClick(ByVal Node As MSComctlLib.Node)
  Dim Obj As Object
  Dim i As Long, j As Long, Found As Boolean
  
  For i = 1 To Files.Count
      If Files(i).Key = Node.Key Then
         Set Obj = Files(i)
         Found = True
         Exit For
      Else
        For j = 1 To Files(i).Objects.Count
            Set Obj = Files(i).Objects(j).GetObj(Node.Key)
            If Not Obj Is Nothing Then
                Found = True
                GoTo Via
            End If
        Next
        For j = 1 To Files(i).Procs.Count
            If Files(i).Procs(j).Key = Node.Key Then
              Set Obj = Files(i).Procs(j)
              Found = True
              GoTo Via
            End If
        Next
     End If
  Next
  
Via:

If Found Then
   Set CurObj = Obj
   Text5 = CurObj.Caption
   Text6 = CurObj.HelpDex
   Text7 = CurObj.HelpRemarks
   Text8 = CurObj.HelpScreenShoot
End If

End Sub


